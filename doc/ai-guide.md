# ESM Styles AI Reference

## Core Patterns

### Basic Style Object to CSS

```js
// Input
{
  button: {
    backgroundColor: 'blue',
    color: 'white',
    padding: '10px 20px'
  }
}

// Output CSS
button {
  background-color: blue;
  color: white;
  padding: 10px 20px;
}
```

### HTML Tags vs Class Selectors

```js
// Tags are recognized directly
{
  div: { margin: '0' },          // -> div { margin: 0; }
  p: { fontSize: '16px' },       // -> p { font-size: 16px; }

  // Non-HTML tags become class selectors
  heading: { display: 'flex' },   // -> .heading { display: flex; }
  card: { padding: '20px' }      // -> .card { padding: 20px; }
}
```

### Nesting

```js
{
  nav: {
    backgroundColor: '#333',

    ul: {
      display: 'flex',

      li: {
        margin: '0 10px',

        a: {
          color: 'white'
        }
      }
    }
  }
}

// Output: Proper nested selectors
// nav { background-color: #333; }
// nav ul { display: flex; }
// nav ul li { margin: 0 10px; }
// nav ul li a { color: white; }
```

### Underscore Conventions

```js
{
  div: {
    // Single underscore: force class selector for tag name
    _p: { fontWeight: 'bold' },      // -> div.p { font-weight: bold; }

    // Double underscore: descendant selector
    __icon: { width: '20px' }        // -> div .icon { width: 20px; }
  }
}
```

### Pseudo-Classes and Special Selectors

```js
{
  button: {
    ':hover': { opacity: 0.9 },                // -> button:hover { opacity: 0.9; }
    '::before': { content: '"→"' },            // -> button::before { content: "→"; }
    '> span': { marginLeft: '5px' },           // -> button > span { margin-left: 5px; }
    '[disabled]': { cursor: 'not-allowed' }    // -> button[disabled] { cursor: not-allowed; }
  }
}
```

### ⚠️ CRITICAL: Ampersand (&) Syntax is NOT Supported

```js
// ❌ WRONG: These will NOT work (common mistake from SCSS/Sass)
{
  button: {
    '&:hover': { opacity: 0.9 },     // ❌ Ampersand not supported
    '&.active': { color: 'red' },     // ❌ Will not work
    '&[disabled]': { opacity: 0.5 }  // ❌ Will not work
  }
}

// ✅ CORRECT: Use direct selectors instead
{
  button: {
    ':hover': { opacity: 0.9 },      // ✅ Direct pseudo-class
    active: { color: 'red' },         // ✅ Class name (if not HTML tag)
    '[disabled]': { opacity: 0.5 }   // ✅ Direct attribute selector
  }
}
```

### Multiple Selectors

```js
{
  'h1, h2, h3': {
    margin: '0 0 1rem'
  },

  'input[type="text"], input[type="email"]': {
    padding: '8px'
  }
}
```

### Media Queries

```js
{
  container: {
    maxWidth: '1200px',

    '@media (max-width: 768px)': {
      maxWidth: '100%'
    },

    '@tablet': {                 // Uses named query from config
      padding: '0 20px'
    }
  }
}
```

### Theme Variants

```js
{
  button: {
    backgroundColor: 'white',

    '@dark': {                   // Applies to :root.dark selector
      backgroundColor: '#222'
    }
  }
}
```

## Using CSS Variables

### CSS Variable Module Pattern

```js
// Import module generated by build process
import $theme from './$theme.mjs'

export default {
  button: {
    // Use variable references - gets converted to var(--color-primary)
    backgroundColor: $theme.color.primary,
    color: $theme.color.textOnPrimary,
  },
}
```

### CSS Variable Objects

```js
// All objects with `var` property are treated as CSS variable references
{
  button: {
    backgroundColor: { var: '--color-primary' }
  }
}
// -> button { background-color: var(--color-primary); }
```

## CLI Usage

```bash
# Build with default config
npx esm-styles build

# Build with custom config
npx esm-styles build path/to/config.js
```

## Config Pattern

```js
// Essential config pattern
export default {
  basePath: './src/styles',
  sourcePath: 'source',
  outputPath: 'css',
  floors: [
    { source: 'base', layer: 'base' },
    { source: 'components', layer: 'components' },
    { source: 'utilities', layer: 'utilities' },
  ],
  importFloors: ['base', 'components', 'utilities'],
  mainCssFile: 'styles.css',

  // Media shorthand definitions
  mediaQueries: {
    mobile: '(max-width: 767px)',
    tablet: '(min-width: 768px) and (max-width: 1024px)',
    desktop: '(min-width: 1025px)',
  },

  // Theme setup
  media: {
    theme: ['light', 'dark'],
  },

  mediaSelectors: {
    theme: {
      light: [
        { selector: '.light' },
        {
          selector: '.auto',
          mediaQuery: 'screen and (prefers-color-scheme: light)',
        },
      ],
      dark: [
        { selector: '.dark' },
        {
          selector: '.auto',
          mediaQuery: 'screen and (prefers-color-scheme: dark)',
        },
      ],
    },
  },
}
```
